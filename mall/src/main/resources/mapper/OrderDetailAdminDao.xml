<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mall.dao.OrderDetailAdminDao">
	
	<select id="getOrderProduct" resultMap="OrdersMap" parameterType="java.util.Date">
		SELECT * 
		FROM tb_order_detail as A,tb_order_product as B 
		WHERE A.order_detail_id = B.order_detail_id and A.create_time <![CDATA[ >= ]]> #{start} and A.create_time <![CDATA[ <= ]]> #{end} and A.enable_status = 4 
	</select>
	
	<select id="queryOrderDetailById" resultMap="OrdersMap">
		SELECT * 
		FROM tb_order_detail as A,tb_order_product as B 
		WHERE A.order_detail_id = B.order_detail_id and B.order_detail_id LIKE '%${value}%'
	</select>
	

	<resultMap type="com.example.mall.entity.Orders" id="OrdersMap">
		<id property="ordersId" column="order_product_id"/>
		<result property="price" column="all_price"/>
		<result property="createTime" column="create_time"/>
		<result property="lastEditTime" column="last_edit_time"/>
		<collection property="ordersDetail"  ofType="OrdersDetail">
			<id property="orderDetailId" column="order_detail_id"/>
			<result property="amount" column="all_amount"/>
			<result property="price" column="all_price"/>
			<result property="userName" column="user_name"/>
			<result property="enableStatus" column="enable_status"/>
		</collection>
		<collection property="product" ofType="Product">
			<id property="productId" column="product_id"/>
			<result property="productName" column="product_name"/>
			<result property="productDesc" column="product_desc"/>
		</collection>
		<collection property="shop" ofType="Shop">
			<id property="shopId" column="shop_id"/>
			<result property="shopName" column="shop_name"/>
		</collection>
	</resultMap>
</mapper>