<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mall.dao.ProductSellDao">

	<select id="selectOrders"  resultType="com.example.mall.entity.SellOrder">
		SELECT *
		FROM tb_order_product as B
		WHERE  B.create_time <![CDATA[ >= ]]> #{arg0} and B.create_time <![CDATA[ <= ]]> #{arg1} and B.shop_id = #{arg2}

	</select>
	<select id="selecctCustomer" resultType="com.example.mall.entity.OrdersDetail">
	SELECT *
	FROM  tb_order_detail WHERE
    order_detail_id=#{0}

	</select>
	
	<!-- 商家登录展示上架商品 计算页数-->
	<select id="showProduct"  resultType="com.example.mall.entity.Product">
		select * from tb_product
		where shop_id=#{0} 
	</select>
	<!-- 分页查看商品 -->
	<select id="pageProduct"  resultType="com.example.mall.entity.Product">
		select * from tb_product
		where shop_id=#{shopId}
		limit #{num},5
	</select>


	<!-- 增加商品 -->
	<insert id="addProduct" parameterType="com.example.mall.entity.Product">
		insert into tb_product
		(product_Name,shop_category_name,product_count,img_addr,shop_id,product_price)
		values
		(#{productName},#{shopCategoryName},#{productCount},#{imgAddr},#{shopId},#{productPrice})
	</insert>

	<update id="updateProduct" parameterType="com.example.mall.entity.Product">
		update tb_product
		 SET product_name=#{productName},shop_category_name=#{shopCategoryName},product_price=#{productPrice},product_count=#{productCount},img_addr=#{imgAddr},product_desc=#{productDesc}
		 WHERE  product_id=#{productId}
	</update>
	<!-- 删除商品 -->
	<delete id="deleteProduct" >
		DELETE  from tb_product
		WHERE  product_id=#{productId}
	</delete>
	<!-- 注册新商铺 -->
	<insert id="save" parameterType="com.example.mall.entity.Shop">
		INSERT  INTO tb_shop (user_name,password,shop_name,shop_address,shop_phone,shop_email)
		VALUES (#{userName},#{password},#{shopName},#{shopAddress},#{shopPhone},#{shopEmail})
	</insert>
	<!-- 查询是否有重复账号 -->
	<select id="findByAccount" resultType="com.example.mall.entity.Shop">
		SELECT * FROM  tb_shop WHERE
		user_name=#{userName}

	</select>

	<!-- 查询是否有重复店铺名 -->
	<select id="findByShopName" resultType="com.example.mall.entity.Shop">
		SELECT * FROM  tb_shop WHERE
		shop_name=#{shopName}

	</select>

	<!-- 查询店铺ID -->
	<select id="findShopId" resultType="string">
		SELECT shop_id  FROM  tb_shop WHERE
		shop_name=#{shopName}

	</select>
	<!-- 登录店铺 -->
	<select id="login"  resultType="com.example.mall.entity.Shop">
		SELECT * from tb_shop
		where user_name=#{w}

	</select>
	<!-- 根据Id查询商品 -->
	<select id="findByProductId" resultType="com.example.mall.entity.Product">
		SELECT * from tb_product
		where product_id=#{1}

	</select>
	<!-- 根据Id查询店铺名 -->
	<select id="findByShopId" resultType="string">
		SELECT  shop_name from tb_shop
		WHERE  shop_id=#{3}

	</select>
	
	<select id="queryProductByProductId" resultType="com.example.mall.entity.Product" parameterType="int">
		select * from tb_product where product_id = #{id};
	</select>
	
	<select id="queryProductById" resultType="com.example.mall.entity.Product" parameterType="int">
		select * from tb_product where shop_id = #{id};
	</select>
	
	<select id="productSerach" resultType="com.example.mall.entity.Product" parameterType="String">
		select * from tb_product where product_name like concat(concat('%',#{name}),'%');
	</select>

</mapper>