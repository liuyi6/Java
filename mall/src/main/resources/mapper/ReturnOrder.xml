<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mall.dao.ReturnOrderDao">
	
	<resultMap type="com.example.mall.entity.ReturnShop" id="orderdetails">
		<id property="orderDetailId" column="order_detail_id" />
		<result property="userName" column="user_uame" />
		<result property="returnStatus" column="return_status" />
		<result property="returnReason" column="return_reason" />
		<result property="userPhone" column="user_phone" />
		<result property="imgAddr" column="img_addr" />
		
	</resultMap>
	
	<select id="queryReturnOrder" resultMap="orderdetails">
		SELECT p.img_addr,p.product_name,op.order_detail_id,od.user_name,od.user_phone,od.return_reason 
		FROM tb_product p,tb_order_detail od,tb_order_product op
		WHERE od.order_detail_id = op.order_detail_id 
		and op.product_id = p.product_id 
		and od.return_status = 1
		and op.shop_id = #{shopId}
	</select>
	
	<update id="agreeReturn" parameterType="com.example.mall.entity.OrdersDetail">
		update tb_order_detail set return_status = 2 where order_detail_id = #{orderDetailId}
	</update>
	
	<update id="disagreeReturn" parameterType="com.example.mall.entity.OrdersDetail">
		update tb_order_detail set return_status = -1 where order_detail_id = #{orderDetailId}
	</update>
	

</mapper>