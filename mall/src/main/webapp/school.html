<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Shop</title>
<meta name="description" content="">
<meta name="keywords" content="">
<!--网站关键词-->
<meta name="Description" Content="">
<!--网站简介-->
<link rel="stylesheet" type="text/css" href="sell/css/bootstrap.css" />
<link rel="stylesheet" href="sell/css/common.css" type="text/css" />
<link rel="stylesheet" href="sell/css/main.css" type="text/css" />

<script type="text/javascript" src="sell/js/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="sell/js/jquery.flexslider-min.js"></script>
<script type="text/javascript" src="sell/js/jquery.SuperSlide.2.1.1.js"></script>
<script type="text/javascript" src="sell/js/cookie_util.js"></script>
<script type="text/javascript" src="sell/js/image.js"></script>
<script type="text/javascript" src="sell/js/main.js"></script>
<script type="text/javascript" src="sell/js/bootstrap.js"></script>
<script type="text/javascript">
	$(function() {
        var shopId=getCookie("shopId");

        if(shopId==null){
            window.location.href="log.html";
        }else {
            //店铺广告
            $(function() {
                $("#okShopAd").on("click", function() {

                    var shopName = $("#sName").val();
                    var adPrize = $("#Pprice").val();
                    var path = $('#Supload').get(0).files[0];

                    
                    var form = new FormData();
                    form.append("shopName", shopName);
                    form.append("price", adPrize);
                    form.append("shopId", shopId);
                    form.append("file", path);
                    $.ajax({
                        url : "/mall/upload/adShop.action",
                        type : "post",
                        data : form,
                        contentType : false,
                        processData : false,
                        dataType : "json",
                        success : function(shop) {
                            window.location.href="/mall/school.html";
                        }
                    })

                })
            });

            //商品广告
            $("#productInfo").on("click", ".pbutton", function () {
            		var proId = $(this).attr("id");
                    
                    $.ajax({
                        url : "/mall/product/findByProductId.do",
                        type : "post",
                        data : {"productId":proId},
                        dataType : "json",
                        success : function(ss) {
                            var pro = ss.data;
                            var proName = pro.productName;
                            var img = pro.imgAddr;
                            var proId = pro.productId;
                            addCookie("proName",proName,2);
                            addCookie("img",img,2);
                            addCookie("proId",proId,2);
                        }
                    })

                })
                
                $("#okProAd").on("click",function(){
                	var proPrice = $("#PadPrize").val();
                	var proName = getCookie("proName");
                	
                	var img = getCookie("img");
                	var proId = getCookie("proId");
                	var shopId = getCookie("shopId");
                	$.ajax({
                		url:"/mall/upload/adProduct.action",
                		type : "post",
                        data : {"proName":proName,"Pprice":proPrice,"img":img,"proId":proId,"shopId":shopId},
                        dataType : "json",
                        success:function(s){
                        	window.location.href="/mall/school.html";
                        }
                	})
                	
                })
            

            $(function() {
                $("#pq").on("click", function() {
                	var shopId = getCookie("shopId");
                    $.ajax({
                        url : "/mall/upload/queryProstate.action",
                        type : "post",
                        data : {"shopId":shopId},
                        dataType : "json",
                        success : function(result) {
                            var list = result.data;
                            for (var i = 0; i < list.length; i++) {
                                var ProName = list[i].productName;
                                var ProState = list[i].enableStatus;
                                var show = "";
                                if (ProState == 0) {
									show = "PEDDING";
								}else if (ProState == 1) {
									show = "PASSED";
								}else if (ProState == -1) {
									show = "NOTPASSED";
								}
                                $("#shopStates").append('<tr><td>Name&nbsp;&nbsp;&nbsp;&nbsp;：<span id="StateName"/>' + ProName + '</td><td>State：<span id="state"/>' + show+'</td></tr>');
                            }

                        }
                    })
                })
               
            });
            
            $(function(){
            	$("#sq").on("click",function(){
            		var shopId = getCookie("shopId"); 
            		$.ajax({
            			url:"/mall/upload/queryShopState.action",
            			type:"post",
            			data:{"shopId":shopId},
            			dataType:"json",
            			success:function(resList){
            				var sList = resList.data;
            				for (var i = 0; i < sList.length; i++) {
            					var shopName = sList[i].shopName;
            					var ProState = sList[i].enableStatus;
            					var show = "";
                                if (ProState == 0) {
									show = "PEDDING";
								}else if (ProState == 1) {
									show = "PASSED";
								}else if (ProState == -1) {
									show = "NOTPASSED";
								}
            					$("#shopStates").append('<tr><td>Name&nbsp;&nbsp;&nbsp;&nbsp;：<span id="StateName"/>'+shopName+'</td><td>State：<span id="state"/>'+show+'</td></tr>');
							}
            			}
            		})
            	})
            	
            });
            $("#okShopState").on("click",function(){
        		/* document.getElementById("shopStates").innerHTML() */
        		$("#shopStates").html('');
        	})
            
            $.ajax({
                url: "/mall/product/findShopName.do",
                type: "post",
                data: {"shopId": shopId},
                dataType: "json",
                success:function(result){
                    addCookie("shopName",result.data,2);
                }

            })

            addCookie("pageNum", 1, 2);
            var shopId = getCookie("shopId");
            $(function () {
                $.ajax({  //查询页数并显示在页面下方
                    url: "/mall/product/showProduct.do",
                    type: "post",
                    data: {"shopId": shopId},
                    dataType: "json",
                    success: function (result) {
                        var product = result.data;
                        var num = result.num;
                        var page = num / 5;
                        $(".fanye").append('<a href="" class="moren" id="1">1</a>');
                        for (var i = 1; i < page; i++) {

                            $(".fanye").append('<a href="" id="' + (i + 1) + '">' + (i + 1) + '</a>');
                        }
                        ;

                    }

                });
                $.ajax({//页面加载显示首页商品
                    url: "/mall/product/pageProduct.do",
                    type: "post",
                    data: {"shopId": shopId, "num": 0},
                    dataType: "json",
                    success: function (result) {
                        var product = result.data;
                        for (var i = 0; i < product.length; i++) {
                            var price = product[i].productPrice;
                            var name = product[i].productName;
                            var type = product[i].shopCategoryName;
                            var kunumber = product[i].productCount;
                            var productId = product[i].productId;
                            var path = product[i].imgAddr;
                            $(".sleft ul").append("<li id='" + productId + "' class='" + name + "'><a><img src='" + path + "'/></a><div class='oooo'><a><h2>" + name + "</h2></a><p>Shop_id:" + shopId + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='commodity_1tel'>Price:" + price + "</span></p><table><tr><td class='td11'>Type：" + type + "</td><td class='td2'>Number：" + kunumber + "</td><td class='td3'>好评率：100%</td></tr><tr><td class='td11'>Comments：0</td><td class='td2'> Sales：0</td><td><p class=\"pbutton\" data-toggle=\"modal\" data-target=\"#ad1\" style=\"margin: 0px;color: #fff\" id='"+productId+"'>Ad-com</p></td></tr></table></div><div class='pppp'><p class='xiugai' data-toggle='modal' data-target='#modal-xiugai' id='" + productId + "'>Modity</p><p class='delete' id='" + productId + "'>Delete</p><a id='" + productId + "' href='news_detail.html' class='annoy'>Detail>></a></div></li>");
                        }
                    }
                });
                $(".fanye ").on("click", "a", function () { //点击页数翻页
                    $(".sleft a ").removeClass("moren");


                    var num = $(this).attr("id");
                    addCookie("pageNum", num, 2);
                    $(this).addClass("moren");
                    num = (num - 1) * 5;
                    $("#productInfo").html("");
                    $.ajax({
                        url: "/mall/product/pageProduct.do",
                        type: "post",
                        data: {"shopId": shopId, "num": num},
                        dataType: "json",
                        success: function (result) {
                            var product = result.data;
                            for (var i = 0; i < product.length; i++) {
                                var price = product[i].productPrice;
                                var name = product[i].productName;
                                var type = product[i].shopCategoryName;
                                var kunumber = product[i].productCount;
                                var path = product[i].imgAddr;
                                var productId = product[i].productId;
                                $(".sleft ul").append("<li id='" + productId + "' class='" + name + "'><a><img src='" + path + "'/></a><div class='oooo'><a><h2>" + name + "</h2></a><p>Shop_id:" + shopId + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='commodity_1tel'>Price:" + price + "</span></p><table><tr><td class='td11'>Type：" + type + "</td><td class='td2'>Number：" + kunumber + "</td><td class='td3'>好评率：100%</td></tr><tr><td class='td11'>Comments：0</td><td class='td2'> Sales：0</td><td><p class=\"pbutton\" data-toggle=\"modal\" data-target=\"#ad1\" style=\"margin: 0px;color: #fff\" id='"+productId+"'>Ad-com</p></td></tr></table></div><div class='pppp'><p class='xiugai' data-toggle='modal' data-target='#modal-xiugai' id='" + productId + "'>Modity</p><p class='delete' id='" + productId + "'>Delete</p><a id='" + productId + "' href='news_detail.html' class='annoy'>Detail>></a></div></li>");
                            }

                        }
                    });
                    return false;
                });
                $("#productInfo").on("click", ".xiugai", function () {
                    var id = $(this).attr("id");
                    addCookie("productId", id, 2);

                });
                $("#ajax1").on("click", function () {
                    var name = $("#name1").val();
                    var type = $("#type1").val();
                    var number = $("#number1").val();
                    var price = $("#prize1").val();
                    var detail = $("#detail1").val();
                    var path = $("#upload1").get(0).files[0];
                    var productId = getCookie("productId");
                    var form = new FormData();
                    form.append("productId", productId);
                    form.append("productName", name);
                    form.append("type", type);
                    form.append("price", price);
                    form.append("kunumber", number);
                    form.append("path", path);
                    form.append("desc", detail);
                    $.ajax({
                        url: "/mall/product/modifyProduct.do",
                        type: "post",
                        data: form,
                        contentType: false,
                        processData: false,
                        dataType: "json",
                        success: function (product) {
                            var page = getCookie("pageNum");
                            window.location.href = "school.html";
                            addCookie("pageNum", page, 2);
                            var page = getCookie("pageNum");
                            num = (num - 1) * 5;
                            $.ajax({
                                url: "/product/pageProduct.do",
                                type: "post",
                                data: {"shopId": shopId, "num": num},
                                dataType: "json",
                                success: function (result) {
                                    var product = result.data;
                                    for (var i = 0; i < product.length; i++) {
                                        var price = product[i].productPrice;
                                        var name = product[i].productName;
                                        var type = product[i].shopCategoryName;
                                        var kunumber = product[i].productCount;
                                        var path = product[i].imgAddr;
                                        var productId = product[i].productId;
                                        $(".sleft ul").append("<li id='" + productId + "' class='" + name + "'><a><img src='" + path + "'/></a><div class='oooo'><a><h2>" + name + "</h2></a><p>Shop_id:" + shopId + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='commodity_1tel'>Price:" + price + "</span></p><table><tr><td class='td11'>Type：" + type + "</td><td class='td2'>Number：" + kunumber + "</td><td class='td3'>好评率：100%</td><td><p class=\"pbutton\" data-toggle=\"modal\" data-target=\"#ad1\" style=\"margin: 0px;color: #fff\" id='"+productId+"'>Ad-com</p></td></tr><tr><td class='td11'>Comments：0</td><td class='td2'> Sales：0</td></tr></table></div><div class='pppp'><p class='xiugai' data-toggle='modal' data-target='#modal-xiugai' id='" + productId + "'>Modity</p><p class='delete' id='" + productId + "'>Delete</p><a id='" + productId + "' href='news_detail.html' class='annoy'>Detail>></a></div></li>");
                                    }

                                }
                            });
                            return false;


                        }
                    });
                })
                $("#productInfo").on("click", ".delete", function () {
                    var id = $(this).attr("id");
                    addCookie("productId", id, 2);
                    $.ajax({
                        url: "/mall/product/deleteProduct.do",
                        type: "post",
                        data: {"productId": id},
                        dataType: "json",
                        success: function (result) {
                            alert("delete success!");
                            var page = getCookie("pageNum");
                            window.location.href = "school.html";
                            $("#productInfo").html("");
                            addCookie("pageNum", page, 2);
                             page = getCookie("pageNum");
                             var num = (page - 1) * 5;
                            $.ajax({
                                url: "/mall/product/pageProduct.do",
                                type: "post",
                                data: {"shopId": shopId, "num": num},
                                dataType: "json",
                                success: function (result) {
                                    var product = result.data;
                                    for (var i = 0; i < product.length; i++) {
                                        var price = product[i].productPrice;
                                        var name = product[i].productName;
                                        var type = product[i].shopCategoryName;
                                        var kunumber = product[i].productCount;
                                        var path = product[i].imgAddr;
                                        var productId = product[i].productId;
                                        $(".sleft ul").append("<li id='" + productId + "' class='" + name + "'><a><img src='" + path + "'/></a><div class='oooo'><a><h2>" + name + "</h2></a><p>Shop_id:" + shopId + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='commodity_1tel'>Price:" + price + "</span></p><table><tr><td class='td11'>Type：" + type + "</td><td class='td2'>Number：" + kunumber + "</td><td class='td3'>好评率：100%</td><td><p class=\"pbutton\" data-toggle=\"modal\" data-target=\"#ad1\" style=\"margin: 0px;color: #fff\" id='"+productId+"'>Ad-com</p></td></tr><tr><td class='td11'>Comments：0</td><td class='td2'> Sales：0</td></tr></table></div><div class='pppp'><p class='xiugai' data-toggle='modal' data-target='#modal-xiugai' id='" + productId + "'>Modity</p><p class='delete' id='" + productId + "'>Delete</p><a id='" + productId + "' href='news_detail.html' class='annoy'>Detail>></a></div></li>");
                                    }

                                }
                            });
                            return false;

                        }

                    })
                });



                $("#productInfo").on("click", ".annoy",function () {
                    var productId=$(this).attr("id");

                    addCookie("productId",productId,2);

                })


            })

        }
	})
</script>
</head>
<body style="background-color: #fff">
	<div class="nav_header">
		<div class="w">
			<div class="user_info">
				<span class="user not_login"> <a class="link" href="index.html">Hi, welcome to PARKnSHOP !</a></span>
			</div>
			<ul class="nav_list">
				<li class="nav_item"><a id="my_ltt" class="link" href="record.html">Order Management</a></li>
				<li class="nav_item"><a class="link" href="tuihuo.html"> Return Management</a></li>
			</ul>
		</div>
	</div>



	<div class="biaoti">
		<span>Store</span>
		<div class="biaoti1">
			Apple
			<p>
				Your location：<a href="">Store</a> > <a href="" class="on">Apple</a>
			</p>
		</div>
	</div>



	<div class="normal mt20">

		<div class="sleft">

			<p class="pbutton" style="margin-left: 20px;" data-toggle="modal" data-target="#ad2">Ad-shop</p>
			
			<p class="pbutton" data-toggle="modal" data-target="#ad3" id="sq">ShopState</p>
			<p class="pbutton" data-toggle="modal" data-target="#ad3" id="pq">ProductState</p>

			<ul id="productInfo">



			</ul>

			<div class="fanye">



			</div>

		</div>


	</div>

	<footer class="footer">
		<ul>
			<li>About Us</li>
			<li>Contact Us</li>
			<li>Terms of Service</li>
			<li>Privacy Agreement</li>
			<li>Help</li>
		</ul>
		<div class="companyName">
			<p>Group 3 of Project Management</p>
		</div>
	</footer>

	<div class="byby">

		<div class="contr_left">

			<a class="sidebtn" title="增加商品"> <b id="off"></b>
			</a>
			<h5>
				<p style="-webkit-transform: rotate(90deg)">Commodity</p>
			</h5>
		</div>

		<div class="contr_right">
			<div>
				name:<input type="text" name="" class="commodity_name"> prize:<input type="text" name=""
					class="commodity_prize"> type:<input type="text" class="commodity_type"> num:<input type="text"
					class="commodity_number">
				<div class="postimg">
					<h3>
						I<br>m<br>a<br>g<br>e
					</h3>
					<input type="file" name="" onchange="PreviewImage(this)" id="upload" class="commodity_images" />
					<div id="imgPreview" class="tupian"></div>
				</div>

				<input type="submit" name="" value="submit" class="commodity_submit">
			</div>
		</div>

	</div>

	<div class="modal fade" id="modal-xiugai">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-biaoti">modify</h4>
				</div>
				<div class="model-body">
					<table class="comtab">
						<tr><td class="com_name">Name&nbsp;&nbsp;&nbsp;&nbsp;：<input type="text" id="name1" name=""></td><td class="com_type">Type：<input  id="type1" type="text" name=""></td></tr>
						<tr><td class="com_kunum">Number：<input id="number1" type="text" name=""></td><td class="com_tel">Prize：<input id="prize1" type="text" name=""></td></tr>
						<tr><td colspan="2"><input type="file" name="" onchange="PreviewImage1(this)" id="upload1" class="commodity_images" style="width: 100%" /><div id="imgPreview1" class="tupian1"></div></td></tr>
						<tr><td colspan="2" style="vertical-align: top;"><p  style="float: left;">Detail：</p><textarea id="detail1" class="com_detail"></textarea></td></tr>
					</table>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal" id="ajax1">OK</button>
					<button type="button" class="btn btn-defalut" data-dismiss="modal" id="quxiao1">CANCEL</button>
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" id="ad1">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-biaoti">商品广告</h4>
				</div>
				<div class="model-body">
					<table class="comtab">
						<tr>
							<td class="ad_prize">Prize：<input type="text" name="adPrize" id="PadPrize"></td>
						</tr>
						
						
					</table>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal" id="okProAd">OK</button>
					<button type="button" class="btn btn-defalut" data-dismiss="modal" id="quxiao2">CANCEL</button>
				</div>
			</div>
		</div>
	</div>

	<div class="modal fade" id="ad2">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-biaoti">店铺广告</h4>
				</div>
				<div class="model-body">
					<table class="comtab">
						<tr>
							<td class="ad_com_name">Name&nbsp;&nbsp;&nbsp;&nbsp;：<input type="text" name="" id="sName"></td>
							<td class="ad_com_prize">Prize：<input type="text" name="" id="Pprice"></td>
						</tr>

						<tr>
							<td colspan="2"><input type="file" name="" onchange="PreviewImage3(this)" id="Supload"
								class="commodity_images" style="width: 100%" />
								<div id="imgPreview3" class="tupian1"></div></td>
						</tr>

					</table>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal" id="okShopAd">OK</button>
					<button type="button" class="btn btn-defalut" data-dismiss="modal" id="quxiao3">CANCEL</button>
				</div>
			</div>
		</div>
	</div>

	<div class="modal fade" id="ad3">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-biaoti">状态查询</h4>
				</div>
				<div class="model-body">
					<table class="comtab" id="shopStates">
					</table>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal" id="okShopState">OK</button>
				</div>
			</div>
		</div>
	</div>
	
</body>
</html>